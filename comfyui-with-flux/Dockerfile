FROM valyriantech/comfyui-without-flux:latest

# === Hugging Face Token (–∂–µ—Å—Ç–∫–æ –≤—à–∏—Ç) ===
ENV HF_TOKEN=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

# === üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ (–±—ã—Å—Ç—Ä—ã–π —Ñ–µ–π–ª, –µ—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π) ===
RUN echo "üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ HuggingFace —Ç–æ–∫–µ–Ω–∞..." && \
    wget --spider --header="Authorization: Bearer ${HF_TOKEN}" \
    "https://huggingface.co/black-forest-labs/FLUX.1-dev/resolve/main/ae.safetensors" || \
    (echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π HF_TOKEN –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –º–æ–¥–µ–ª–∏!" && exit 1)

# === üü£ FLUX: VAE ===
RUN echo "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ FLUX VAE (ae.safetensors)..." && \
    wget --progress=dot:giga --header="Authorization: Bearer ${HF_TOKEN}" \
    -O /ComfyUI/models/vae/ae.safetensors \
    "https://huggingface.co/black-forest-labs/FLUX.1-dev/resolve/main/ae.safetensors?download=true"

# === üîµ FLUX: UNet ===
RUN echo "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ FLUX UNet (flux1-dev.safetensors)..." && \
    wget --progress=dot:giga --header="Authorization: Bearer ${HF_TOKEN}" \
    -O /ComfyUI/models/diffusion_models/flux1-dev.safetensors \
    "https://huggingface.co/black-forest-labs/FLUX.1-dev/resolve/main/flux1-dev.safetensors?download=true"

# === üü° FLUX CLIP –º–æ–¥–µ–ª–∏ ===
RUN echo "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ CLIP –º–æ–¥–µ–ª–µ–π..." && \
    wget --progress=dot:giga \
    -O /ComfyUI/models/clip/clip_l.safetensors \
    "https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/clip_l.safetensors?download=true" && \
    wget --progress=dot:giga \
    -O /ComfyUI/models/clip/t5xxl_fp8_e4m3fn.safetensors \
    "https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp8_e4m3fn.safetensors?download=true"

# === üß° LoRA –º–æ–¥–µ–ª–∏ ===
RUN echo "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ LoRA –º–æ–¥–µ–ª–µ–π..." && \
    wget --progress=dot:giga \
    -O /ComfyUI/models/loras/GracePenelopeTargaryenV5.safetensors \
    "https://huggingface.co/WouterGlorieux/GracePenelopeTargaryenV5/resolve/main/GracePenelopeTargaryenV5.safetensors?download=true" && \
    wget --progress=dot:giga \
    -O /ComfyUI/models/loras/VideoAditor_flux_realism_lora.safetensors \
    "https://huggingface.co/VideoAditor/Flux-Lora-Realism/resolve/main/flux_realism_lora.safetensors?download=true" && \
    mkdir -p /ComfyUI/models/xlabs/loras && \
    wget --progress=dot:giga \
    -O /ComfyUI/models/xlabs/loras/Xlabs-AI_flux-RealismLora.safetensors \
    "https://huggingface.co/XLabs-AI/flux-RealismLora/resolve/main/lora.safetensors?download=true"

# === üöÄ –ó–∞–ø—É—Å–∫ ComfyUI ===
CMD ["/start.sh"]
